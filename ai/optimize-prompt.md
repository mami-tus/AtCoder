私は TypeScript で AtCoder 問題を解きました。
以下のコードを、実務で使える品質に引き上げるために最適化してください。

## 1. 要求事項

1. **可読性・保守性の向上**
   - 関数・変数の命名見直し
   - モジュール分割や責務の明確化
   - docstring／コメントの追加
2. **アルゴリズム最適化**
   - 時間計算量・空間計算量の改善提案
   - 大規模入力（例：N ≤ 10^5）対応のボトルネック解消
3. **設計パターン適用**
   - SOLID 原則への準拠
   - 適切なデザインパターン（Factory, Strategy など）の導入
4. **テスト容易性の強化**
   - ユニットテスト（Jest／Vitest）のサンプル追加
   - モックやスタブの利用例

## 2. 出力フォーマット

- **diff 形式** で変更箇所を提示
- リファクタ後の **完全なコード**
- 各変更点に対する **簡潔な解説**（「なぜ」「どう改善したか」）

## 3. 元コード

```typescript
// ここにあなたの AtCoder 解答コードを貼り付けてください
```
